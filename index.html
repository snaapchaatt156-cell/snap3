<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Responsive Mobile Video Gallery</title>

  <!-- Bootstrap 5 (CDN) -->
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

  <style>
    :root{
      --bg: #0f1724;
      --card: #0b1220;
      --text: #e6eef8;
      --muted: #9aa7bd;
      --accent: #4f46e5;
    }
    [data-theme="light"]{
      --bg: #f7fafc;
      --card: #ffffff;
      --text: #0b1220;
      --muted: #475569;
      --accent: #2563eb;
    }

    html,body{
      height:100%;
      background:linear-gradient(180deg, rgba(0,0,0,0.12), transparent), var(--bg);
      color:var(--text);
      font-family: Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial;
    }

    .container {
      padding-top: 1rem;
      padding-bottom: 4rem;
    }

    /* Header */
    .app-header{
      display:flex;
      gap:.5rem;
      align-items:center;
      justify-content:space-between;
      margin-bottom: .75rem;
    }
    .app-title{
      display:flex;
      gap:.75rem;
      align-items:center;
    }
    .logo{
      width:40px;height:40px;border-radius:8px;background:linear-gradient(135deg,var(--accent),#06b6d4);
      display:flex;align-items:center;justify-content:center;font-weight:700;color:white;
      box-shadow: 0 4px 18px rgba(2,6,23,0.6);
      font-size:14px;
    }

    /* Gallery */
    .video-card{
      background:var(--card);
      border-radius:12px;
      overflow:hidden;
      transition: transform .14s ease, box-shadow .14s ease;
      position:relative;
      min-height: 150px;
    }
    .video-card:active, .video-card:hover{
      transform: translateY(-6px);
      box-shadow: 0 10px 30px rgba(2,6,23,0.48);
    }
    .thumb {
      width:100%;
      display:block;
      height: 180px;
      object-fit:cover;
      background:linear-gradient(90deg, rgba(0,0,0,0.1), rgba(0,0,0,0.2));
    }
    .card-body {
      padding: .6rem .6rem .8rem;
    }
    .video-title{
      color:var(--text);
      margin:0;
      font-weight:600;
      font-size: .98rem;
      white-space:nowrap;
      overflow:hidden;
      text-overflow:ellipsis;
    }
    .video-meta{
      color:var(--muted);
      font-size:.83rem;
    }

    .play-btn {
      position:absolute;
      left:50%;
      top:50%;
      transform:translate(-50%,-50%);
      width:56px;height:56px;border-radius:50%;
      background:rgba(0,0,0,0.6);display:flex;align-items:center;justify-content:center;
      border: 2px solid rgba(255,255,255,0.08);backdrop-filter: blur(6px);
    }
    .play-btn svg{ width:26px;height:26px;color:white; }

    /* Player modal */
    .player-modal{
      --modal-bg: rgba(2,6,23,0.94);
      background: linear-gradient(180deg, rgba(0,0,0,0.95), rgba(0,0,0,0.9));
      position:fixed;inset:0;z-index:1050;display:none;align-items:center;justify-content:center;padding:0.5rem;
    }
    .player-modal.open{ display:flex; }

    .player-shell{
      width:100%;
      max-width:1000px;
      height:100%;
      max-height:100vh;
      border-radius:12px;
      overflow:hidden;
      display:flex;
      flex-direction:column;
      background:transparent;
    }

    .player-topbar{
      display:flex;align-items:center;gap:.5rem;padding:.6rem;background:transparent;color:var(--text);
    }
    .btn-ghost{
      background: rgba(255,255,255,0.04);
      border: none;color:var(--text);
      border-radius:10px;padding:.45rem .6rem;
    }

    .video-wrap{
      position:relative;flex:1;display:flex;align-items:center;justify-content:center;
      background:linear-gradient(180deg, rgba(0,0,0,0.6), rgba(0,0,0,0.3));
    }
    video.app-video{
      width:100%;height:100%;max-height:calc(100vh - 86px);object-fit:contain;background:black;
      touch-action:manipulation;
    }

    .buffer-spinner{
      position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);z-index:20;display:none;
    }
    .buffer-spinner.show{display:block;}

    /* controls hint (touch friendly) */
    .touch-hint{ font-size:.85rem;color:var(--muted);padding:.4rem .6rem; }

    /* grid/list specifics */
    .list-mode .thumb{ height:120px; width:220px; object-fit:cover; border-radius:8px; }
    .list-card{ display:flex; gap:.75rem; align-items:center; padding:.6rem; }

    /* small devices */
    @media (max-width:576px){
      .thumb{ height:140px; }
      .video-card{ border-radius:10px; }
      .play-btn{ width:48px;height:48px; }
    }

    /* orientation handling: full-bleed video in landscape */
    @media (orientation: landscape) and (max-height:600px){
      .player-shell{ border-radius:0; max-width:100%; max-height:100vh; }
      video.app-video{ object-fit:cover; height:100vh; max-height:unset; }
    }

  </style>
</head>
<body data-theme="dark">
  <div class="container">
    <header class="app-header">
      <div class="app-title">
        <div class="logo">V</div>
        <div>
          <div style="font-weight:700;">Video Gallery</div>
          <div style="font-size:.82rem;color:var(--muted)">Responsive • Mobile-optimized • HTML5 video</div>
        </div>
      </div>

      <div class="d-flex gap-2 align-items-center">
        <div class="btn-group btn-group-sm me-2" role="group" aria-label="view mode">
          <button id="gridBtn" class="btn btn-outline-light btn-sm active" title="Grid view">Grid</button>
          <button id="listBtn" class="btn btn-outline-light btn-sm" title="List view">List</button>
        </div>

        <button id="themeToggle" class="btn btn-ghost" aria-pressed="false" title="Toggle dark / light">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none" aria-hidden><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
      </div>
    </header>

    <!-- Gallery -->
    <main>
      <div class="row g-3" id="gallery" aria-live="polite"></div>
    </main>
  </div>

  <!-- Player Modal (custom full-screen) -->
  <div id="playerModal" class="player-modal" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="player-shell shadow">
      <div class="player-topbar">
        <button id="backBtn" class="btn-ghost" title="Back" aria-label="Back">
          <svg width="18" height="18" viewBox="0 0 24 24" fill="none"><path d="M15 18l-6-6 6-6" stroke="currentColor" stroke-width="1.6" stroke-linecap="round" stroke-linejoin="round"/></svg>
        </button>
        <div id="playerTitle" style="flex:1;font-weight:600"></div>
        <div class="touch-hint d-none d-sm-block">Tap video to show controls</div>
      </div>

      <div class="video-wrap">
        <div class="buffer-spinner" id="spinner" aria-hidden="true">
          <svg width="84" height="84" viewBox="0 0 44 44" stroke="white">
            <g fill="none" fill-rule="evenodd" stroke-width="2">
              <circle cx="22" cy="22" r="1">
                <animate attributeName="r" begin="0s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"/>
                <animate attributeName="stroke-opacity" begin="0s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"/>
              </circle>
              <circle cx="22" cy="22" r="1">
                <animate attributeName="r" begin="-0.9s" dur="1.8s" values="1; 20" calcMode="spline" keyTimes="0; 1" keySplines="0.165, 0.84, 0.44, 1" repeatCount="indefinite"/>
                <animate attributeName="stroke-opacity" begin="-0.9s" dur="1.8s" values="1; 0" calcMode="spline" keyTimes="0; 1" keySplines="0.3, 0.61, 0.355, 1" repeatCount="indefinite"/>
              </circle>
            </g>
          </svg>
        </div>

        <video id="playerVideo"
               class="app-video"
               controls
               playsinline
               preload="metadata"
               controlsList="nodownload"
               webkit-playsinline
               x5-playsinline
               crossorigin="anonymous"
               aria-label="Video player">
          <!-- sources added dynamically -->
          Your browser does not support the video tag.
        </video>
      </div>
    </div>
  </div>

  <!-- Bootstrap JS (CDN) and Popper minimal - only if required -->
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

  <script>
    // ========== Sample video dataset ==========
    // Replace URLs and thumbnails with your own uploaded files for production.
    const videos = [
      {
        id: 'v1',
        title: 'BF ko sex ke liye manaya, Uska Land mera andar ghusa to itna maja aya, WOW. App log bhi kabhi try karo bohot maja aiga.',
        //poster: '',
        sources: [
          { type: 'video/mp4', src: '1.mp4' },
          //{ type: 'video/webm', src: 'https://interactive-examples.mdn.mozilla.net/media/cc0-videos/flower.webm' }
        ],
       
      },
      {
        id: 'v2',
        title: 'Sex karne me bohot maja ata hai',
        //poster: 'https://peach.blender.org/wp-content/uploads/title_anouncement.jpg?x11217',
        sources: [
          { type: 'video/mp4', src: '2.mp4' },
          //{ type: 'video/webm', src: 'https://storage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.webm' }
        ],
        
      },
      {
        id: 'v3',
        title: 'BF ke upar chadh ke kiya',
        //poster: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/images/ForBiggerMeltdowns.jpg',
        sources: [
          { type: 'video/mp4', src: '3.mp4' },
          //{ type: 'video/webm', src: 'https://storage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.webm' }
        ],
       
      },
      {
        id: 'v4',
        title: 'Condom lagake sex karo pregnant hone se baacho',
        //poster: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/75/Sintel_poster.jpg/640px-Sintel_poster.jpg',
        sources: [
          { type: 'video/mp4', src: '4.mp4' },
          //{ type: 'video/webm', src: 'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.webm' }
        ],
        
      },
      {
        id: 'v5',
        title: 'Soutele bhai se to sex ho jata hai',
        //poster: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/75/Sintel_poster.jpg/640px-Sintel_poster.jpg',
        sources: [
          { type: 'video/mp4', src: '5.mp4' },
          //{ type: 'video/webm', src: 'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.webm' }
        ],
        
      },
      {
        id: 'v6',
        title: 'App bhi kabhi chus ke dekho maja jan paoge',
        //poster: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/75/Sintel_poster.jpg/640px-Sintel_poster.jpg',
        sources: [
          { type: 'video/mp4', src: '6.mp4' },
          //{ type: 'video/webm', src: 'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.webm' }
        ],
        
      },
      {
        id: 'v7',
        title: 'Soutele bhai ka land se pura maja le liya',
        //poster: 'https://upload.wikimedia.org/wikipedia/commons/thumb/7/75/Sintel_poster.jpg/640px-Sintel_poster.jpg',
        sources: [
          { type: 'video/mp4', src: '7.mp4' },
          //{ type: 'video/webm', src: 'https://storage.googleapis.com/gtv-videos-bucket/sample/Sintel.webm' }
        ],
        
      },
    ];

    // ========== DOM references ==========
    const gallery = document.getElementById('gallery');
    const playerModal = document.getElementById('playerModal');
    const playerVideo = document.getElementById('playerVideo');
    const playerTitle = document.getElementById('playerTitle');
    const backBtn = document.getElementById('backBtn');
    const spinner = document.getElementById('spinner');
    const gridBtn = document.getElementById('gridBtn');
    const listBtn = document.getElementById('listBtn');
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;

    let currentVideoId = null;
    let isListMode = false;
    let observerThumbs;

    // ========== Build gallery ==========
    function createCard(video) {
      const col = document.createElement('div');
      col.className = 'col-12 col-sm-6 col-md-4';

      const card = document.createElement('article');
      card.className = 'video-card';
      card.tabIndex = 0;
      card.setAttribute('role', 'button');
      card.setAttribute('aria-pressed', 'false');

      // thumbnail image (lazy)
      const img = document.createElement('img');
      img.className = 'thumb';
      img.alt = video.title + ' thumbnail';
      img.dataset.src = video.poster; // lazy load
      img.loading = 'lazy';

      // overlay play button
      const playBtn = document.createElement('div');
      playBtn.className = 'play-btn';
      playBtn.innerHTML = '<svg viewBox="0 0 24 24" fill="none" aria-hidden><path d="M5 3v18l15-9-15-9z" fill="currentColor"></path></svg>';

      // captions
      const bodyDiv = document.createElement('div');
      bodyDiv.className = 'card-body';

      const title = document.createElement('h3');
      title.className = 'video-title';
      title.textContent = video.title;

      const meta = document.createElement('div');
      meta.className = 'video-meta';
      meta.textContent = video.duration;

      bodyDiv.appendChild(title);
      bodyDiv.appendChild(meta);

      card.appendChild(img);
      card.appendChild(playBtn);
      card.appendChild(bodyDiv);

      // click handlers
      [card, playBtn].forEach(el => {
        el.addEventListener('click', (e) => {
          e.preventDefault();
          openPlayer(video.id);
        });
        el.addEventListener('keyup', (e) => {
          if(e.key === 'Enter' || e.key === ' ') openPlayer(video.id);
        });
      });

      col.appendChild(card);
      return col;
    }

    function renderGallery() {
      gallery.innerHTML = '';
      const fragment = document.createDocumentFragment();
      for (const v of videos) {
        fragment.appendChild(createCard(v));
      }
      gallery.appendChild(fragment);

      // thumbnails lazy-load via IntersectionObserver
      initThumbnailObserver();
    }

    // ========== Lazy load thumbnails ==========
    function initThumbnailObserver(){
      if(observerThumbs) observerThumbs.disconnect();

      const options = { root: null, rootMargin: '200px', threshold: 0.01 };
      observerThumbs = new IntersectionObserver((entries, obs) => {
        entries.forEach(entry => {
          if(entry.isIntersecting){
            const img = entry.target;
            const src = img.dataset.src;
            if(src && !img.src){
              img.src = src;
            }
            obs.unobserve(img);
          }
        });
      }, options);

      document.querySelectorAll('.thumb').forEach(img => observerThumbs.observe(img));
    }

    // ========== Player open/close logic ==========
    function openPlayer(videoId) {
      const video = videos.find(v => v.id === videoId);
      if(!video) return;

      currentVideoId = videoId;
      playerTitle.textContent = video.title;
      playerModal.classList.add('open');
      playerModal.setAttribute('aria-hidden', 'false');

      // push history state so back button works
      try {
        history.pushState({ videoOpen: true, id: videoId }, video.title, `#${videoId}`);
      } catch(e){}

      // Clear previous sources
      while (playerVideo.firstChild) playerVideo.removeChild(playerVideo.firstChild);

      // Determine preload based on connection. If good network, preload metadata; else none.
      let netType = 'unknown';
      try {
        netType = navigator.connection && navigator.connection.effectiveType ? navigator.connection.effectiveType : netType;
      } catch(e){}

      if (['4g'].includes(netType)) {
        playerVideo.preload = 'metadata';
      } else {
        // conservative for slow mobile networks/data
        playerVideo.preload = 'none';
      }

      // Add sources lazily
      for(const s of video.sources){
        const sourceEl = document.createElement('source');
        sourceEl.src = s.src;
        sourceEl.type = s.type;
        playerVideo.appendChild(sourceEl);
      }

      // set poster from dataset if available
      if (video.poster) {
        playerVideo.poster = video.poster;
      }

      // ensure UI updates, then try fullscreen
      showSpinner(true);
      playerVideo.load();

      // attach buffer/ready events
      const onCanPlay = () => {
        showSpinner(false);
        // attempt to enter fullscreen on mobile if possible & user gesture (we opened from click so allowed)
        requestVideoFullscreen();
        playerVideo.play().catch(()=>{ /* autoplay might be blocked; user can press play */ });
        cleanupEvents();
      };

      const onWaiting = () => { showSpinner(true); };
      const onPlaying = () => { showSpinner(false); };

      const cleanupEvents = () => {
        playerVideo.removeEventListener('canplay', onCanPlay);
        playerVideo.removeEventListener('playing', onPlaying);
        playerVideo.removeEventListener('waiting', onWaiting);
      };

      playerVideo.addEventListener('canplay', onCanPlay);
      playerVideo.addEventListener('playing', onPlaying);
      playerVideo.addEventListener('waiting', onWaiting);
    }

    function closePlayer() {
      // stop playback, clear sources
      try {
        playerVideo.pause();
        playerVideo.removeAttribute('src');
        while (playerVideo.firstChild) playerVideo.removeChild(playerVideo.firstChild);
        playerVideo.poster = '';
        playerVideo.load();
      } catch(e){}
      playerModal.classList.remove('open');
      playerModal.setAttribute('aria-hidden', 'true');
      showSpinner(false);

      // pop history state to remove hash if needed
      if(location.hash) {
        try { history.pushState({}, '', location.pathname + location.search); } catch(e){}
      }
      currentVideoId = null;
    }

    function showSpinner(show){
      spinner.classList.toggle('show', !!show);
    }

    // request element fullscreen (with fallbacks)
    async function requestVideoFullscreen(){
      const el = playerModal;
      if (!el) return;
      try {
        if (el.requestFullscreen) await el.requestFullscreen({ navigationUI: 'hide' });
        else if (el.webkitRequestFullscreen) await el.webkitRequestFullscreen();
        // else rely on modal styling
      } catch(e){}
    }

    async function exitFullscreenIfAny(){
      try {
        if (document.fullscreenElement) await document.exitFullscreen();
        else if (document.webkitFullscreenElement) await document.webkitCancelFullScreen();
      } catch(e){}
    }

    // ========== Back button handlers (UI & browser) ==========
    backBtn.addEventListener('click', () => {
      closePlayer();
      exitFullscreenIfAny();
    });

    // handle browser back (popstate)
    window.addEventListener('popstate', (e) => {
      // if modal open, close it
      if (currentVideoId !== null) {
        closePlayer();
        exitFullscreenIfAny();
      }
    });

    // also close player if clicked outside video area (on overlay)
    playerModal.addEventListener('click', (e) => {
      if (e.target === playerModal) {
        closePlayer();
        exitFullscreenIfAny();
      }
    });

    // stop video on Escape fullscreen exit
    document.addEventListener('fullscreenchange', () => {
      if (!document.fullscreenElement && currentVideoId === null) return;
    });

    // ========== Grid / List toggle ==========
    gridBtn.addEventListener('click', () => {
      isListMode = false;
      gridBtn.classList.add('active');
      listBtn.classList.remove('active');
      gallery.classList.remove('list-mode');
      renderGallery();
    });
    listBtn.addEventListener('click', () => {
      isListMode = true;
      gridBtn.classList.remove('active');
      listBtn.classList.add('active');
      gallery.classList.add('list-mode');
      renderListMode();
    });

    function renderListMode(){
      // Render as list: make each card full-width with thumbnail left and details right
      gallery.innerHTML = '';
      const frag = document.createDocumentFragment();
      videos.forEach(v => {
        const col = document.createElement('div');
        col.className = 'col-12';

        const card = document.createElement('div');
        card.className = 'video-card list-card';
        card.tabIndex = 0;
        card.setAttribute('role', 'button');

        const img = document.createElement('img');
        img.className = 'thumb';
        img.dataset.src = v.poster;
        img.loading = 'lazy';
        img.alt = v.title + ' thumbnail';

        const content = document.createElement('div');
        content.style.flex = '1';

        const title = document.createElement('h3');
        title.className = 'video-title';
        title.textContent = v.title;

        const meta = document.createElement('div');
        meta.className = 'video-meta';
        meta.textContent = v.duration;

        const playSmall = document.createElement('button');
        playSmall.className = 'btn btn-primary btn-sm mt-2';
        playSmall.textContent = 'Play';
        playSmall.addEventListener('click', (e) => { e.stopPropagation(); openPlayer(v.id); });

        content.appendChild(title);
        content.appendChild(meta);
        content.appendChild(playSmall);

        card.appendChild(img);
        card.appendChild(content);

        card.addEventListener('click', () => openPlayer(v.id));

        col.appendChild(card);
        frag.appendChild(col);
      });
      gallery.appendChild(frag);
      initThumbnailObserver();
    }

    // ========== Theme toggle ==========
    themeToggle.addEventListener('click', () => {
      const current = body.getAttribute('data-theme') || 'dark';
      const next = current === 'dark' ? 'light' : 'dark';
      body.setAttribute('data-theme', next);
      themeToggle.setAttribute('aria-pressed', (next === 'light').toString());
    });

    // ========== Initialize ==========
    renderGallery();

    // ========== Accessibility & mobile tips ==========
    // Tap the video area to show native controls on some mobile browsers.
    playerVideo.addEventListener('touchstart', () => {
      // no-op but ensures quick touch responsiveness
    });

    // Pause video when pressing home/back etc via visibility change
    document.addEventListener('visibilitychange', () => {
      if (document.hidden) {
        try { playerVideo.pause(); } catch(e){}
      }
    });

    // Attempt buffer optimization: if network is slow, reduce playback quality if multiple sources available
    (function bufferOpt() {
      try {
        const conn = navigator.connection;
        if (!conn) return;
        conn.addEventListener && conn.addEventListener('change', () => {
          // adjust preload policy for next open based on effectiveType
          // (we already check effectiveType when opening)
        });
      } catch(e){}
    })();

    // Clean up when page unloads
    window.addEventListener('pagehide', () => {
      try { playerVideo.pause(); } catch(e){}
    });

    // If user navigates to a hash with video id, open it (deep linking)
    document.addEventListener('DOMContentLoaded', () => {
      if (location.hash) {
        const id = location.hash.replace('#','');
        if (videos.some(v => v.id === id)) {
          // small timeout to allow render
          setTimeout(()=>openPlayer(id), 300);
        }
      }
    });
  </script>
</body>
</html>
